Loading training data...
Using 19 files out of 198 (10.0% of dataset)
Found 19 matching SSM-LB file pairs
Loading all data into memory for balanced sampling...
Found 19 files to process
Added 3475 points to the memory
Loaded 1001: 3475 annotated points; (excluded 0 non-annotated)
Loaded 1001: 3475 points
Added 18827 points to the memory
Loaded 2435: 18827 annotated points; (excluded 0 non-annotated)
Loaded 2435: 18827 points
Added 8117 points to the memory
Loaded 1611: 8117 annotated points; (excluded 0 non-annotated)
Loaded 1611: 8117 points
Added 14604 points to the memory
Loaded 1840: 14604 annotated points; (excluded 0 non-annotated)
Loaded 1840: 14604 points
Added 9144 points to the memory
Loaded 1751: 9144 annotated points; (excluded 0 non-annotated)
Loaded 1751: 9144 points
Added 12789 points to the memory
Loaded 0746: 12789 annotated points; (excluded 0 non-annotated)
Loaded 0746: 12789 points
Added 15410 points to the memory
Loaded 0513: 15410 annotated points; (excluded 0 non-annotated)
Loaded 0513: 15410 points
Added 22256 points to the memory
Loaded 1173: 22256 annotated points; (excluded 0 non-annotated)
Loaded 1173: 22256 points
Added 10978 points to the memory
Loaded 1761: 10978 annotated points; (excluded 0 non-annotated)
Loaded 1761: 10978 points
Added 10196 points to the memory
Loaded 1226: 10196 annotated points; (excluded 0 non-annotated)
Loaded 1226: 10196 points
Added 6734 points to the memory
Loaded 0189: 6734 annotated points; (excluded 0 non-annotated)
Loaded 0189: 6734 points
Added 12747 points to the memory
Loaded 0654: 12747 annotated points; (excluded 0 non-annotated)
Loaded 0654: 12747 points
Added 2750 points to the memory
Loaded 1608: 2750 annotated points; (excluded 0 non-annotated)
Loaded 1608: 2750 points
Added 11288 points to the memory
Loaded 0233: 11288 annotated points; (excluded 0 non-annotated)
Loaded 0233: 11288 points
Added 12802 points to the memory
Loaded 1627: 12802 annotated points; (excluded 0 non-annotated)
Loaded 1627: 12802 points
Added 11286 points to the memory
Loaded 2690: 11286 annotated points; (excluded 0 non-annotated)
Loaded 2690: 11286 points
Added 9075 points to the memory
Loaded 1739: 9075 annotated points; (excluded 0 non-annotated)
Loaded 1739: 9075 points
Added 7018 points to the memory
Loaded 2714: 7018 annotated points; (excluded 0 non-annotated)
Loaded 2714: 7018 points
Added 7735 points to the memory
Loaded 0871: 7735 annotated points; (excluded 0 non-annotated)
Loaded 0871: 7735 points

=== Data Loading Summary ===
Total points in dataset: 207231
Non-annotated points (excluded): 0
Annotated points (kept for training): 207231
Filtering ratio: 100.00%

=== Class Distribution ===
Class 0 (non-edge): 194659 points (93.93%)
Class 1 (edge): 12572 points (6.07%)
== Preparing balanced points... ==
Class 0: 194659 points
Class 1: 12572 points
Maximum class size: 194659
Class 0: replicated to 194659 points
Class 1: replicated to 194659 points
Total balanced pool size: 389318
== Finish Preparing balanced points... ==
Found 50 matching SSM-LB file pairs
Loading all data into memory for balanced sampling...
Found 50 files to process
Added 18826 points to the memory
Loaded 2139: 18826 annotated points; (excluded 0 non-annotated)
Loaded 2139: 18826 points
Added 16623 points to the memory
Loaded 1155: 16623 annotated points; (excluded 0 non-annotated)
Loaded 1155: 16623 points
Added 16137 points to the memory
Loaded 0994: 16137 annotated points; (excluded 0 non-annotated)
Loaded 0994: 16137 points
Added 10499 points to the memory
Loaded 1884: 10499 annotated points; (excluded 0 non-annotated)
Loaded 1884: 10499 points
Added 19659 points to the memory
Loaded 1051: 19659 annotated points; (excluded 0 non-annotated)
Loaded 1051: 19659 points
Added 22574 points to the memory
Loaded 2465: 22574 annotated points; (excluded 0 non-annotated)
Loaded 2465: 22574 points
Added 1555 points to the memory
Loaded 2117: 1555 annotated points; (excluded 0 non-annotated)
Loaded 2117: 1555 points
Added 16478 points to the memory
Loaded 1957: 16478 annotated points; (excluded 0 non-annotated)
Loaded 1957: 16478 points
Added 20205 points to the memory
Loaded 2431: 20205 annotated points; (excluded 0 non-annotated)
Loaded 2431: 20205 points
Added 22028 points to the memory
Loaded 2248: 22028 annotated points; (excluded 0 non-annotated)
Loaded 2248: 22028 points
Added 11879 points to the memory
Loaded 0576: 11879 annotated points; (excluded 0 non-annotated)
Loaded 0576: 11879 points
Added 15903 points to the memory
Loaded 0277: 15903 annotated points; (excluded 0 non-annotated)
Loaded 0277: 15903 points
Added 16339 points to the memory
Loaded 2038: 16339 annotated points; (excluded 0 non-annotated)
Loaded 2038: 16339 points
Added 8263 points to the memory
Loaded 1402: 8263 annotated points; (excluded 0 non-annotated)
Loaded 1402: 8263 points
Added 8242 points to the memory
Loaded 1534: 8242 annotated points; (excluded 0 non-annotated)
Loaded 1534: 8242 points
Added 10371 points to the memory
Loaded 0844: 10371 annotated points; (excluded 0 non-annotated)
Loaded 0844: 10371 points
Added 7601 points to the memory
Loaded 1384: 7601 annotated points; (excluded 0 non-annotated)
Loaded 1384: 7601 points
Added 1798 points to the memory
Loaded 1612: 1798 annotated points; (excluded 0 non-annotated)
Loaded 1612: 1798 points
Added 5238 points to the memory
Loaded 1672: 5238 annotated points; (excluded 0 non-annotated)
Loaded 1672: 5238 points
Added 2327 points to the memory
Loaded 1258: 2327 annotated points; (excluded 0 non-annotated)
Loaded 1258: 2327 points
Added 10681 points to the memory
Loaded 0402: 10681 annotated points; (excluded 0 non-annotated)
Loaded 0402: 10681 points
Added 8263 points to the memory
Loaded 2572: 8263 annotated points; (excluded 0 non-annotated)
Loaded 2572: 8263 points
Added 24817 points to the memory
Loaded 0667: 24817 annotated points; (excluded 0 non-annotated)
Loaded 0667: 24817 points
Added 11949 points to the memory
Loaded 2703: 11949 annotated points; (excluded 0 non-annotated)
Loaded 2703: 11949 points
Added 6738 points to the memory
Loaded 2192: 6738 annotated points; (excluded 0 non-annotated)
Loaded 2192: 6738 points
Added 34340 points to the memory
Loaded 0353: 34340 annotated points; (excluded 0 non-annotated)
Loaded 0353: 34340 points
Added 1950 points to the memory
Loaded 0939: 1950 annotated points; (excluded 0 non-annotated)
Loaded 0939: 1950 points
Added 16446 points to the memory
Loaded 0643: 16446 annotated points; (excluded 0 non-annotated)
Loaded 0643: 16446 points
Added 17117 points to the memory
Loaded 1813: 17117 annotated points; (excluded 0 non-annotated)
Loaded 1813: 17117 points
Added 17431 points to the memory
Loaded 1937: 17431 annotated points; (excluded 0 non-annotated)
Loaded 1937: 17431 points
Added 5520 points to the memory
Loaded 0198: 5520 annotated points; (excluded 0 non-annotated)
Loaded 0198: 5520 points
Added 23925 points to the memory
Loaded 2775: 23925 annotated points; (excluded 0 non-annotated)
Loaded 2775: 23925 points
Added 9086 points to the memory
Loaded 0487: 9086 annotated points; (excluded 0 non-annotated)
Loaded 0487: 9086 points
Added 27164 points to the memory
Loaded 1716: 27164 annotated points; (excluded 0 non-annotated)
Loaded 1716: 27164 points
Added 13974 points to the memory
Loaded 1323: 13974 annotated points; (excluded 0 non-annotated)
Loaded 1323: 13974 points
Added 27323 points to the memory
Loaded 1217: 27323 annotated points; (excluded 0 non-annotated)
Loaded 1217: 27323 points
Added 8124 points to the memory
Loaded 2337: 8124 annotated points; (excluded 0 non-annotated)
Loaded 2337: 8124 points
Added 1004 points to the memory
Loaded 0713: 1004 annotated points; (excluded 0 non-annotated)
Loaded 0713: 1004 points
Added 18663 points to the memory
Loaded 2667: 18663 annotated points; (excluded 0 non-annotated)
Loaded 2667: 18663 points
Added 4867 points to the memory
Loaded 2738: 4867 annotated points; (excluded 0 non-annotated)
Loaded 2738: 4867 points
Added 12716 points to the memory
Loaded 0091: 12716 annotated points; (excluded 0 non-annotated)
Loaded 0091: 12716 points
Added 9583 points to the memory
Loaded 2392: 9583 annotated points; (excluded 0 non-annotated)
Loaded 2392: 9583 points
Added 25136 points to the memory
Loaded 2507: 25136 annotated points; (excluded 0 non-annotated)
Loaded 2507: 25136 points
Added 1950 points to the memory
Loaded 1594: 1950 annotated points; (excluded 0 non-annotated)
Loaded 1594: 1950 points
Added 29317 points to the memory
Loaded 1743: 29317 annotated points; (excluded 0 non-annotated)
Loaded 1743: 29317 points
Added 12841 points to the memory
Loaded 0541: 12841 annotated points; (excluded 0 non-annotated)
Loaded 0541: 12841 points
Added 1454 points to the memory
Loaded 1106: 1454 annotated points; (excluded 0 non-annotated)
Loaded 1106: 1454 points
Added 26287 points to the memory
Loaded 0008: 26287 annotated points; (excluded 0 non-annotated)
Loaded 0008: 26287 points
Added 22419 points to the memory
Loaded 1433: 22419 annotated points; (excluded 0 non-annotated)
Loaded 1433: 22419 points
Added 6581 points to the memory
Loaded 0138: 6581 annotated points; (excluded 0 non-annotated)
Loaded 0138: 6581 points

=== Data Loading Summary ===
Total points in dataset: 690211
Non-annotated points (excluded): 0
Annotated points (kept for training): 690211
Filtering ratio: 100.00%

=== Class Distribution ===
Class 0 (non-edge): 650122 points (94.19%)
Class 1 (edge): 40089 points (5.81%)
Training data shape: (391168, 320)
Validation data shape: (692224, 320)
Training labels distribution: [195584 195584]
Grouping features by descriptors...
After grouping - Training data shape: (391168, 20)
After grouping - Validation data shape: (692224, 20)
Calculating descriptor relevance for scanning order...
Scanning order (by relevance): [ 0 16 17  2  3 18  6 15 12  9 11  7 10  1 19  5 13  4 14  8]
Starting RL training with SADRLFS approach...
============================================================

--- Episode 1/5 ---
Episode 1 - Epsilon: 1.000 (100.0% random, 0.0% DQN)
Starting with empty feature set...
Scanning order (by relevance): [ 0 16 17  2  3 18  6 15 12  9 11  7 10  1 19  5 13  4 14  8]

Step 0: Scanning descriptor 0 (position 1/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 0
  Action: DESELECT descriptor 0
  New selection: []
  No descriptors selected, reward: 0

Step 1: Scanning descriptor 16 (position 2/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): SELECT descriptor 16
  Action: SELECT descriptor 16
  New selection: [np.int64(16)]
  Calculating reward for descriptors: [np.int64(16)]
  Total reward: 1.5954, Per descriptor: 1.5954

Step 2: Scanning descriptor 17 (position 3/20)
  Currently selected descriptors: [np.int64(16)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 17
  Action: SELECT descriptor 17
  New selection: [np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(16), np.int64(17)]
  Total reward: 1.6266, Per descriptor: 0.8133

Step 3: Scanning descriptor 2 (position 4/20)
  Currently selected descriptors: [np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 2
  Action: DESELECT descriptor 2
  New selection: [np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(16), np.int64(17)]
  Total reward: 1.6266, Per descriptor: 0.8133

Step 4: Scanning descriptor 3 (position 5/20)
  Currently selected descriptors: [np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 3
  Action: SELECT descriptor 3
  New selection: [np.int64(3), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(16), np.int64(17)]
  Total reward: 1.6279, Per descriptor: 0.5426

Step 5: Scanning descriptor 18 (position 6/20)
  Currently selected descriptors: [np.int64(3), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 18
  Action: DESELECT descriptor 18
  New selection: [np.int64(3), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(16), np.int64(17)]
  Total reward: 1.6279, Per descriptor: 0.5426

Step 6: Scanning descriptor 6 (position 7/20)
  Currently selected descriptors: [np.int64(3), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 6
  Action: SELECT descriptor 6
  New selection: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Total reward: 1.6205, Per descriptor: 0.4051

Step 7: Scanning descriptor 15 (position 8/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 15
  Action: DESELECT descriptor 15
  New selection: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Total reward: 1.6205, Per descriptor: 0.4051

Step 8: Scanning descriptor 12 (position 9/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 12
  Action: DESELECT descriptor 12
  New selection: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Total reward: 1.6205, Per descriptor: 0.4051

Step 9: Scanning descriptor 9 (position 10/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 9
  Action: DESELECT descriptor 9
  New selection: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Total reward: 1.6205, Per descriptor: 0.4051

Step 10: Scanning descriptor 11 (position 11/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 11
  Action: DESELECT descriptor 11
  New selection: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  Total reward: 1.6205, Per descriptor: 0.4051

Step 11: Scanning descriptor 7 (position 12/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 7
  Action: SELECT descriptor 7
  New selection: [np.int64(3), np.int64(6), np.int64(7), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(7), np.int64(16), np.int64(17)]
  Total reward: 1.6152, Per descriptor: 0.3230

Step 12: Scanning descriptor 10 (position 13/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(7), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 10
  Action: SELECT descriptor 10
  New selection: [np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17)]
  Total reward: 1.6040, Per descriptor: 0.2673

Step 13: Scanning descriptor 1 (position 14/20)
  Currently selected descriptors: [np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 1
  Action: SELECT descriptor 1
  New selection: [np.int64(1), np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17)]
  Total reward: 1.5948, Per descriptor: 0.2278

Step 14: Scanning descriptor 19 (position 15/20)
  Currently selected descriptors: [np.int64(1), np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 19
  Action: SELECT descriptor 19
  New selection: [np.int64(1), np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17), np.int64(19)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17), np.int64(19)]
  Total reward: 1.5904, Per descriptor: 0.1988

Step 15: Scanning descriptor 5 (position 16/20)
  Currently selected descriptors: [np.int64(1), np.int64(3), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17), np.int64(19)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 5
  Action: SELECT descriptor 5
  New selection: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17), np.int64(19)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17), np.int64(19)]
  Total reward: 1.5881, Per descriptor: 0.1765

Step 16: Scanning descriptor 13 (position 17/20)
  Currently selected descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(16), np.int64(17), np.int64(19)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 13
  Action: SELECT descriptor 13
  New selection: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Total reward: 1.5879, Per descriptor: 0.1588

Step 17: Scanning descriptor 4 (position 18/20)
  Currently selected descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 4
  Action: DESELECT descriptor 4
  New selection: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Total reward: 1.5879, Per descriptor: 0.1588

Step 18: Scanning descriptor 14 (position 19/20)
  Currently selected descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 14
  Action: DESELECT descriptor 14
  New selection: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Total reward: 1.5879, Per descriptor: 0.1588

Step 19: Scanning descriptor 8 (position 20/20)
  Currently selected descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 8
  Action: SELECT descriptor 8
  New selection: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Calculating reward for descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Total reward: 1.5786, Per descriptor: 0.1435
  Updated target network weights
  NEW BEST! Reward: 30.5418 with 11 descriptors
Episode 1 Summary:
  Total reward: 30.5418
  Steps taken: 20
  Final descriptors: 11
  Selected descriptors: [np.int64(1), np.int64(3), np.int64(5), np.int64(6), np.int64(7), np.int64(8), np.int64(10), np.int64(13), np.int64(16), np.int64(17), np.int64(19)]
  Epsilon: 1.000 (100.0% random, 0.0% DQN)
  Avg last 10 episodes: 30.5418
  Best so far: 30.5418 (11 descriptors)

--- Episode 2/5 ---
Episode 2 - Epsilon: 0.775 (77.5% random, 22.5% DQN)
Starting with empty feature set...
Scanning order (by relevance): [ 0 16 17  2  3 18  6 15 12  9 11  7 10  1 19  5 13  4 14  8]

Step 0: Scanning descriptor 0 (position 1/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): SELECT descriptor 0
  Action: SELECT descriptor 0
  New selection: [np.int64(0)]
  Calculating reward for descriptors: [np.int64(0)]
  Total reward: 1.6601, Per descriptor: 1.6601

Step 1: Scanning descriptor 16 (position 2/20)
  Currently selected descriptors: [np.int64(0)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 16
  Action: SELECT descriptor 16
  New selection: [np.int64(0), np.int64(16)]
  Calculating reward for descriptors: [np.int64(0), np.int64(16)]
  Total reward: 1.6481, Per descriptor: 0.8240

Step 2: Scanning descriptor 17 (position 3/20)
  Currently selected descriptors: [np.int64(0), np.int64(16)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 17
  Action: DESELECT descriptor 17
  New selection: [np.int64(0), np.int64(16)]
  Calculating reward for descriptors: [np.int64(0), np.int64(16)]
  Total reward: 1.6481, Per descriptor: 0.8240

Step 3: Scanning descriptor 2 (position 4/20)
  Currently selected descriptors: [np.int64(0), np.int64(16)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 2
  Action: DESELECT descriptor 2
  New selection: [np.int64(0), np.int64(16)]
  Calculating reward for descriptors: [np.int64(0), np.int64(16)]
  Total reward: 1.6481, Per descriptor: 0.8240

Step 4: Scanning descriptor 3 (position 5/20)
  Currently selected descriptors: [np.int64(0), np.int64(16)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 3
  Action: SELECT descriptor 3
  New selection: [np.int64(0), np.int64(3), np.int64(16)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(16)]
  Total reward: 1.6390, Per descriptor: 0.5463

Step 5: Scanning descriptor 18 (position 6/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(16)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 18
  Action: SELECT descriptor 18
  New selection: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Total reward: 1.6356, Per descriptor: 0.4089

Step 6: Scanning descriptor 6 (position 7/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 6
  Action: DESELECT descriptor 6
  New selection: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Total reward: 1.6356, Per descriptor: 0.4089

Step 7: Scanning descriptor 15 (position 8/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 15
  Action: DESELECT descriptor 15
  New selection: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Total reward: 1.6356, Per descriptor: 0.4089

Step 8: Scanning descriptor 12 (position 9/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 12
  Action: DESELECT descriptor 12
  New selection: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  Total reward: 1.6356, Per descriptor: 0.4089

Step 9: Scanning descriptor 9 (position 10/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 9
  Action: SELECT descriptor 9
  New selection: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  Total reward: 1.6269, Per descriptor: 0.3254

Step 10: Scanning descriptor 11 (position 11/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 11
  Action: DESELECT descriptor 11
  New selection: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  Total reward: 1.6269, Per descriptor: 0.3254

Step 11: Scanning descriptor 7 (position 12/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 7
  Action: DESELECT descriptor 7
  New selection: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  Total reward: 1.6269, Per descriptor: 0.3254

Step 12: Scanning descriptor 10 (position 13/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 10
  Action: SELECT descriptor 10
  New selection: [np.int64(0), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18)]
  Total reward: 1.6204, Per descriptor: 0.2701

Step 13: Scanning descriptor 1 (position 14/20)
  Currently selected descriptors: [np.int64(0), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 1
  Action: SELECT descriptor 1
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18)]
  Total reward: 1.6177, Per descriptor: 0.2311

Step 14: Scanning descriptor 19 (position 15/20)
  Currently selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 19
  Action: SELECT descriptor 19
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18), np.int64(19)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18), np.int64(19)]
  Total reward: 1.6120, Per descriptor: 0.2015

Step 15: Scanning descriptor 5 (position 16/20)
  Currently selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 5
  Action: DESELECT descriptor 5
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18), np.int64(19)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18), np.int64(19)]
  Total reward: 1.6120, Per descriptor: 0.2015

Step 16: Scanning descriptor 13 (position 17/20)
  Currently selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(16), np.int64(18), np.int64(19)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 13
  Action: SELECT descriptor 13
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Total reward: 1.6073, Per descriptor: 0.1786

Step 17: Scanning descriptor 4 (position 18/20)
  Currently selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 4
  Action: DESELECT descriptor 4
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Total reward: 1.6073, Per descriptor: 0.1786

Step 18: Scanning descriptor 14 (position 19/20)
  Currently selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 14
  Action: DESELECT descriptor 14
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Total reward: 1.6073, Per descriptor: 0.1786

Step 19: Scanning descriptor 8 (position 20/20)
  Currently selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 8
  Action: DESELECT descriptor 8
  New selection: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Calculating reward for descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Total reward: 1.6073, Per descriptor: 0.1786
  NEW BEST! Reward: 32.5579 with 9 descriptors
Episode 2 Summary:
  Total reward: 32.5579
  Steps taken: 20
  Final descriptors: 9
  Selected descriptors: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
  Epsilon: 0.775 (77.5% random, 22.5% DQN)
  Avg last 10 episodes: 31.5498
  Best so far: 32.5579 (9 descriptors)

--- Episode 3/5 ---
Episode 3 - Epsilon: 0.550 (55.0% random, 45.0% DQN)
Starting with empty feature set...
Scanning order (by relevance): [ 0 16 17  2  3 18  6 15 12  9 11  7 10  1 19  5 13  4 14  8]

Step 0: Scanning descriptor 0 (position 1/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 0
  Action: DESELECT descriptor 0
  New selection: []
  No descriptors selected, reward: 0

Step 1: Scanning descriptor 16 (position 2/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 16
  Action: DESELECT descriptor 16
  New selection: []
  No descriptors selected, reward: 0

Step 2: Scanning descriptor 17 (position 3/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 17
  Action: DESELECT descriptor 17
  New selection: []
  No descriptors selected, reward: 0

Step 3: Scanning descriptor 2 (position 4/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): SELECT descriptor 2
  Action: SELECT descriptor 2
  New selection: [np.int64(2)]
  Calculating reward for descriptors: [np.int64(2)]
  Total reward: 1.5815, Per descriptor: 1.5815

Step 4: Scanning descriptor 3 (position 5/20)
  Currently selected descriptors: [np.int64(2)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 3
  Action: DESELECT descriptor 3
  New selection: [np.int64(2)]
  Calculating reward for descriptors: [np.int64(2)]
  Total reward: 1.5815, Per descriptor: 1.5815

Step 5: Scanning descriptor 18 (position 6/20)
  Currently selected descriptors: [np.int64(2)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 18
  Action: DESELECT descriptor 18
  New selection: [np.int64(2)]
  Calculating reward for descriptors: [np.int64(2)]
  Total reward: 1.5815, Per descriptor: 1.5815

Step 6: Scanning descriptor 6 (position 7/20)
  Currently selected descriptors: [np.int64(2)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 6
  Action: DESELECT descriptor 6
  New selection: [np.int64(2)]
  Calculating reward for descriptors: [np.int64(2)]
  Total reward: 1.5815, Per descriptor: 1.5815

Step 7: Scanning descriptor 15 (position 8/20)
  Currently selected descriptors: [np.int64(2)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 15
  Action: SELECT descriptor 15
  New selection: [np.int64(2), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(15)]
  Total reward: 1.6026, Per descriptor: 0.8013

Step 8: Scanning descriptor 12 (position 9/20)
  Currently selected descriptors: [np.int64(2), np.int64(15)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 12
  Action: DESELECT descriptor 12
  New selection: [np.int64(2), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(15)]
  Total reward: 1.6026, Per descriptor: 0.8013

Step 9: Scanning descriptor 9 (position 10/20)
  Currently selected descriptors: [np.int64(2), np.int64(15)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 9
  Action: DESELECT descriptor 9
  New selection: [np.int64(2), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(15)]
  Total reward: 1.6026, Per descriptor: 0.8013

Step 10: Scanning descriptor 11 (position 11/20)
  Currently selected descriptors: [np.int64(2), np.int64(15)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 11
  Action: DESELECT descriptor 11
  New selection: [np.int64(2), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(15)]
  Total reward: 1.6026, Per descriptor: 0.8013

Step 11: Scanning descriptor 7 (position 12/20)
  Currently selected descriptors: [np.int64(2), np.int64(15)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 7
  Action: SELECT descriptor 7
  New selection: [np.int64(2), np.int64(7), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(7), np.int64(15)]
  Total reward: 1.6000, Per descriptor: 0.5333

Step 12: Scanning descriptor 10 (position 13/20)
  Currently selected descriptors: [np.int64(2), np.int64(7), np.int64(15)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 10
  Action: DESELECT descriptor 10
  New selection: [np.int64(2), np.int64(7), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(7), np.int64(15)]
  Total reward: 1.6000, Per descriptor: 0.5333

Step 13: Scanning descriptor 1 (position 14/20)
  Currently selected descriptors: [np.int64(2), np.int64(7), np.int64(15)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 1
  Action: DESELECT descriptor 1
  New selection: [np.int64(2), np.int64(7), np.int64(15)]
  Calculating reward for descriptors: [np.int64(2), np.int64(7), np.int64(15)]
  Total reward: 1.6000, Per descriptor: 0.5333

Step 14: Scanning descriptor 19 (position 15/20)
  Currently selected descriptors: [np.int64(2), np.int64(7), np.int64(15)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 19
  Action: SELECT descriptor 19
  New selection: [np.int64(2), np.int64(7), np.int64(15), np.int64(19)]
  Calculating reward for descriptors: [np.int64(2), np.int64(7), np.int64(15), np.int64(19)]
  Total reward: 1.5931, Per descriptor: 0.3983

Step 15: Scanning descriptor 5 (position 16/20)
  Currently selected descriptors: [np.int64(2), np.int64(7), np.int64(15), np.int64(19)]
  State shape: (49,)
  Action chosen (random): SELECT descriptor 5
  Action: SELECT descriptor 5
  New selection: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Calculating reward for descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Total reward: 1.5909, Per descriptor: 0.3182

Step 16: Scanning descriptor 13 (position 17/20)
  Currently selected descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 13
  Action: DESELECT descriptor 13
  New selection: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Calculating reward for descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Total reward: 1.5909, Per descriptor: 0.3182

Step 17: Scanning descriptor 4 (position 18/20)
  Currently selected descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 4
  Action: DESELECT descriptor 4
  New selection: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Calculating reward for descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Total reward: 1.5909, Per descriptor: 0.3182

Step 18: Scanning descriptor 14 (position 19/20)
  Currently selected descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 14
  Action: DESELECT descriptor 14
  New selection: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Calculating reward for descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Total reward: 1.5909, Per descriptor: 0.3182

Step 19: Scanning descriptor 8 (position 20/20)
  Currently selected descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 8
  Action: DESELECT descriptor 8
  New selection: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Calculating reward for descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Total reward: 1.5909, Per descriptor: 0.3182
Episode 3 Summary:
  Total reward: 27.0838
  Steps taken: 20
  Final descriptors: 5
  Selected descriptors: [np.int64(2), np.int64(5), np.int64(7), np.int64(15), np.int64(19)]
  Epsilon: 0.550 (55.0% random, 45.0% DQN)
  Avg last 10 episodes: 30.0612
  Best so far: 32.5579 (9 descriptors)

--- Episode 4/5 ---
Episode 4 - Epsilon: 0.325 (32.5% random, 67.5% DQN)
Starting with empty feature set...
Scanning order (by relevance): [ 0 16 17  2  3 18  6 15 12  9 11  7 10  1 19  5 13  4 14  8]

Step 0: Scanning descriptor 0 (position 1/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 0
  Action: DESELECT descriptor 0
  New selection: []
  No descriptors selected, reward: 0

Step 1: Scanning descriptor 16 (position 2/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): DESELECT descriptor 16
  Action: DESELECT descriptor 16
  New selection: []
  No descriptors selected, reward: 0

Step 2: Scanning descriptor 17 (position 3/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 17
  Action: DESELECT descriptor 17
  New selection: []
  No descriptors selected, reward: 0

Step 3: Scanning descriptor 2 (position 4/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 2
  Action: DESELECT descriptor 2
  New selection: []
  No descriptors selected, reward: 0

Step 4: Scanning descriptor 3 (position 5/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 3
  Action: DESELECT descriptor 3
  New selection: []
  No descriptors selected, reward: 0

Step 5: Scanning descriptor 18 (position 6/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 18
  Action: DESELECT descriptor 18
  New selection: []
  No descriptors selected, reward: 0

Step 6: Scanning descriptor 6 (position 7/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 6
  Action: DESELECT descriptor 6
  New selection: []
  No descriptors selected, reward: 0

Step 7: Scanning descriptor 15 (position 8/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 15
  Action: DESELECT descriptor 15
  New selection: []
  No descriptors selected, reward: 0

Step 8: Scanning descriptor 12 (position 9/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 12
  Action: DESELECT descriptor 12
  New selection: []
  No descriptors selected, reward: 0

Step 9: Scanning descriptor 9 (position 10/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 9
  Action: DESELECT descriptor 9
  New selection: []
  No descriptors selected, reward: 0

Step 10: Scanning descriptor 11 (position 11/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 11
  Action: DESELECT descriptor 11
  New selection: []
  No descriptors selected, reward: 0

Step 11: Scanning descriptor 7 (position 12/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 7
  Action: DESELECT descriptor 7
  New selection: []
  No descriptors selected, reward: 0

Step 12: Scanning descriptor 10 (position 13/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 10
  Action: DESELECT descriptor 10
  New selection: []
  No descriptors selected, reward: 0

Step 13: Scanning descriptor 1 (position 14/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 1
  Action: DESELECT descriptor 1
  New selection: []
  No descriptors selected, reward: 0

Step 14: Scanning descriptor 19 (position 15/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 19
  Action: DESELECT descriptor 19
  New selection: []
  No descriptors selected, reward: 0

Step 15: Scanning descriptor 5 (position 16/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 5
  Action: DESELECT descriptor 5
  New selection: []
  No descriptors selected, reward: 0

Step 16: Scanning descriptor 13 (position 17/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 13
  Action: DESELECT descriptor 13
  New selection: []
  No descriptors selected, reward: 0

Step 17: Scanning descriptor 4 (position 18/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 4
  Action: DESELECT descriptor 4
  New selection: []
  No descriptors selected, reward: 0

Step 18: Scanning descriptor 14 (position 19/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 14
  Action: DESELECT descriptor 14
  New selection: []
  No descriptors selected, reward: 0

Step 19: Scanning descriptor 8 (position 20/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 8
  Action: DESELECT descriptor 8
  New selection: []
  No descriptors selected, reward: 0
Episode 4 Summary:
  Total reward: 0.0000
  Steps taken: 20
  Final descriptors: 0
  Selected descriptors: []
  Epsilon: 0.325 (32.5% random, 67.5% DQN)
  Avg last 10 episodes: 22.5459
  Best so far: 32.5579 (9 descriptors)

--- Episode 5/5 ---
Episode 5 - Epsilon: 0.100 (10.0% random, 90.0% DQN)
Starting with empty feature set...
Scanning order (by relevance): [ 0 16 17  2  3 18  6 15 12  9 11  7 10  1 19  5 13  4 14  8]

Step 0: Scanning descriptor 0 (position 1/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 0
  Action: DESELECT descriptor 0
  New selection: []
  No descriptors selected, reward: 0

Step 1: Scanning descriptor 16 (position 2/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 16
  Action: DESELECT descriptor 16
  New selection: []
  No descriptors selected, reward: 0

Step 2: Scanning descriptor 17 (position 3/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 17
  Action: DESELECT descriptor 17
  New selection: []
  No descriptors selected, reward: 0

Step 3: Scanning descriptor 2 (position 4/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 2
  Action: DESELECT descriptor 2
  New selection: []
  No descriptors selected, reward: 0

Step 4: Scanning descriptor 3 (position 5/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 3
  Action: DESELECT descriptor 3
  New selection: []
  No descriptors selected, reward: 0

Step 5: Scanning descriptor 18 (position 6/20)
  Currently selected descriptors: None
  State shape: (49,)
  Action chosen (random): SELECT descriptor 18
  Action: SELECT descriptor 18
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 6: Scanning descriptor 6 (position 7/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 6
  Action: DESELECT descriptor 6
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 7: Scanning descriptor 15 (position 8/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 15
  Action: DESELECT descriptor 15
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 8: Scanning descriptor 12 (position 9/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 12
  Action: DESELECT descriptor 12
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 9: Scanning descriptor 9 (position 10/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 9
  Action: DESELECT descriptor 9
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 10: Scanning descriptor 11 (position 11/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 11
  Action: DESELECT descriptor 11
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 11: Scanning descriptor 7 (position 12/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 7
  Action: DESELECT descriptor 7
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 12: Scanning descriptor 10 (position 13/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 10
  Action: DESELECT descriptor 10
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 13: Scanning descriptor 1 (position 14/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 1
  Action: DESELECT descriptor 1
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 14: Scanning descriptor 19 (position 15/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 19
  Action: DESELECT descriptor 19
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 15: Scanning descriptor 5 (position 16/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 5
  Action: DESELECT descriptor 5
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 16: Scanning descriptor 13 (position 17/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 13
  Action: DESELECT descriptor 13
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 17: Scanning descriptor 4 (position 18/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 4
  Action: DESELECT descriptor 4
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 18: Scanning descriptor 14 (position 19/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 14
  Action: DESELECT descriptor 14
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355

Step 19: Scanning descriptor 8 (position 20/20)
  Currently selected descriptors: [np.int64(18)]
  State shape: (49,)
  Action chosen (DQN): DESELECT descriptor 8
  Action: DESELECT descriptor 8
  New selection: [np.int64(18)]
  Calculating reward for descriptors: [np.int64(18)]
  Total reward: 1.5355, Per descriptor: 1.5355
Episode 5 Summary:
  Total reward: 23.0332
  Steps taken: 20
  Final descriptors: 1
  Selected descriptors: [np.int64(18)]
  Epsilon: 0.100 (10.0% random, 90.0% DQN)
  Avg last 10 episodes: 22.6433
  Best so far: 32.5579 (9 descriptors)

Training completed!
Best descriptors found: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]
Number of best descriptors: 9
Final validation accuracy: 0.9886
Selected descriptor indices: [np.int64(0), np.int64(1), np.int64(3), np.int64(9), np.int64(10), np.int64(13), np.int64(16), np.int64(18), np.int64(19)]

================================================================================
DESCRIPTOR RANKING BY USAGE
================================================================================
Rank | Descriptor | Times Used | Total Reward
-----------------------------------------------
   1 | Desc17     |        38  |     15.3949
   2 | Desc 4     |        32  |      9.7009
   3 | Desc19     |        30  |     27.2635
   4 | Desc 1     |        20  |      8.9088
   5 | Desc 8     |        18  |      5.4025
   6 | Desc18     |        18  |      6.5508
   7 | Desc20     |        18  |      4.1017
   8 | Desc 3     |        17  |     13.1203
   9 | Desc11     |        16  |      3.1088
  10 | Desc 2     |        14  |      2.5714
  11 | Desc 7     |        14  |      3.8390
  12 | Desc16     |        13  |      6.7944
  13 | Desc10     |        11  |      2.5947
  14 | Desc 6     |        10  |      2.3872
  15 | Desc14     |         8  |      1.3343
  16 | Desc 9     |         1  |      0.1435
  17 | Desc 5     |         0  |      0.0000
  18 | Desc12     |         0  |      0.0000
  19 | Desc13     |         0  |      0.0000
  20 | Desc15     |         0  |      0.0000

Top Descriptors by Usage Frequency:
Top 4 most used: ['Desc17', 'Desc4', 'Desc19', 'Desc1']
Top 8 most used: ['Desc17', 'Desc4', 'Desc19', 'Desc1', 'Desc8', 'Desc18', 'Desc20', 'Desc3']
Top 12 most used: ['Desc17', 'Desc4', 'Desc19', 'Desc1', 'Desc8', 'Desc18', 'Desc20', 'Desc3', 'Desc11', 'Desc2', 'Desc7', 'Desc16']

Column graph saved to: result_rl_single_agent/descriptor_rewards_column_graph.png
PDF version also saved: result_rl_single_agent/descriptor_rewards_column_graph.pdf
